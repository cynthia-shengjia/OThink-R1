# ============================================================================
# OThink-R1 评测配置文件
# ============================================================================
# 放置于: OThink-R1/othink_config.yaml
# 由 othink_cli.py 读取，定义所有数据集、模型和评测参数的映射关系。
# ============================================================================

# HuggingFace 镜像 (国内加速, 设为 null 则用官方源)
hf_mirror: https://hf-mirror.com

# 项目根路径 ("auto" = 自动检测)
project_root: auto

# ---------------------------------------------------------------------------
# 数据集配置
# ---------------------------------------------------------------------------
# hf_repo        : HuggingFace 仓库 ID
# repo_type      : 仓库类型 (dataset)
# local_dir      : 本地路径 (相对于 project_root)
# deer_name      : DEER 格式数据集名 (在 baseline/deer/data/ 下, null=不支持)
# standard_name  : 标准评测 Hydra 配置名 (null=不支持)
# ---------------------------------------------------------------------------
datasets:
  math:
    hf_repo: DigitalLearningGmbH/MATH-lighteval
    repo_type: dataset
    local_dir: datasets/MATH
    deer_name: math_hf
    standard_name: MATHBench
    description: "MATH benchmark, 7个难度等级的数学竞赛题"

  aime:
    hf_repo: AI-MO/aimo-validation-aime
    repo_type: dataset
    local_dir: datasets/AIME
    deer_name: aime_hf
    standard_name: AIME
    description: "AIME 美国数学邀请赛验证集"

  asdiv:
    hf_repo: EleutherAI/asdiv
    repo_type: dataset
    local_dir: datasets/ASDIV
    deer_name: asdiv_hf
    standard_name: ASDIV
    description: "ASDiv 多样化算术应用题数据集"

  gsm8k:
    hf_repo: openai/gsm8k
    repo_type: dataset
    local_dir: datasets/GSM8K
    deer_name: gsm8k
    standard_name: null
    description: "GSM8K 小学数学推理数据集"

  gpqa:
    hf_repo: Idavidrein/gpqa
    repo_type: dataset
    local_dir: datasets/GPQA
    deer_name: gpqa
    standard_name: null
    description: "GPQA 研究生水平科学问答基准"

  livecodebench:
    hf_repo: livecodebench/code_generation_lite
    repo_type: dataset
    local_dir: datasets/livecodebench/code_generation_lite
    deer_name: null
    standard_name: null
    description: "LiveCodeBench 实时代码生成评测"

# ---------------------------------------------------------------------------
# 模型配置
# ---------------------------------------------------------------------------
# hf_repo       : HuggingFace 仓库 ID
# local_dir     : 本地路径 (相对于 project_root)
# hydra_config  : 标准评测 Hydra 配置名 (对应 OThinkR1Training/config/model/*.yaml)
# family        : 模型家族
# params        : 参数量
# ---------------------------------------------------------------------------
models:
  # Qwen2.5 Instruct 系列
  qwen-0.5b:
    hf_repo: Qwen/Qwen2.5-0.5B-Instruct
    local_dir: models/Qwen2.5-0.5B-Instruct
    hydra_config: Qwen2.5-0.5B-Instruct
    family: qwen2.5
    params: 0.5B

  qwen-1.5b:
    hf_repo: Qwen/Qwen2.5-1.5B-Instruct
    local_dir: models/Qwen2.5-1.5B-Instruct
    hydra_config: Qwen2.5-1.5B-Instruct
    family: qwen2.5
    params: 1.5B

  qwen-7b:
    hf_repo: Qwen/Qwen2.5-7B-Instruct
    local_dir: models/Qwen2.5-7B-Instruct
    hydra_config: Qwen2.5-7B-Instruct
    family: qwen2.5
    params: 7B

  qwen-14b:
    hf_repo: Qwen/Qwen2.5-14B-Instruct
    local_dir: models/Qwen2.5-14B-Instruct
    hydra_config: Qwen2.5-14B-Instruct
    family: qwen2.5
    params: 14B

  # DeepSeek-R1 Distill 系列
  deepseek-r1-1.5b:
    hf_repo: deepseek-ai/DeepSeek-R1-Distill-Qwen-1.5B
    local_dir: models/DeepSeek-R1-Distill-Qwen-1.5B
    hydra_config: DeepSeek-R1-Distill-Qwen-1.5B-Fix
    family: deepseek-r1
    params: 1.5B

  deepseek-r1-7b:
    hf_repo: deepseek-ai/DeepSeek-R1-Distill-Qwen-7B
    local_dir: models/DeepSeek-R1-Distill-Qwen-7B
    hydra_config: DeepSeek-R1-Distill-Qwen-7B-Fix
    family: deepseek-r1
    params: 7B

  deepseek-r1-14b:
    hf_repo: deepseek-ai/DeepSeek-R1-Distill-Qwen-14B
    local_dir: models/DeepSeek-R1-Distill-Qwen-14B
    hydra_config: DeepSeek-R1-Distill-Qwen-14B-Fix
    family: deepseek-r1
    params: 14B

# ---------------------------------------------------------------------------
# 评测默认参数
# ---------------------------------------------------------------------------
eval_defaults:
  standard:
    temperature: 0.9
    top_p: 0.95
    max_tokens: 4096
    repetition_penalty: 1.0
    gpu_memory_utilization: 0.9

  deer:
    threshold: 0.95
    max_len: 16384
    think_ratio: 0.9
    temperature: 0.0
    top_p: 1.0
    policy: avg1
    batch_size: 2000

  cp_router:
    tau: 1
    beta: 3.0
    cal_ratio: 0.3
    batch_size: 8
    max_tokens: 4096

  livecodebench:
    max_model_len: 4096
    max_tokens: 4096
    num_process: 12
    timeout: 6

# ---------------------------------------------------------------------------
# GPU 自动分配
# ---------------------------------------------------------------------------
gpu_auto_allocation:
  rules:
    - max_params: 1.5B
      tp_size: 1
    - max_params: 7B
      tp_size: 1
    - max_params: 14B
      tp_size: 2
    - max_params: 72B
      tp_size: 4
  default_tp_size: 1
